var M=Object.defineProperty;var P=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var R=(e,o,a)=>o in e?M(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,y=(e,o)=>{for(var a in o||(o={}))D.call(o,a)&&R(e,a,o[a]);if(P)for(var a of P(o))G.call(o,a)&&R(e,a,o[a]);return e};import{e as H,d as J,c as C}from"./QTable.e0927851.js";import{Q as K}from"./QPage.59fa2915.js";import{T as x}from"./TotalComponent.d07ae23c.js";import{P as i}from"./LocalStorage.43f5bae5.js";import{B as $,c as f,r as g,a0 as T,_ as E,C as h,L as z,F as p,D as W,E as X,J as S,K as F,G as Y}from"./index.66094083.js";import{u as Z}from"./wallets-store.49ae660f.js";import{u as _}from"./records-store.1ebab12b.js";import{u as ee}from"./categories-store.e394f13f.js";import{u as oe}from"./operations-store.e8425649.js";import"./QBtn.ff23d35c.js";import"./QSpinner.db282beb.js";import"./use-dark.3a898bfd.js";import"./selection.9b47585d.js";import"./format.3e32b8d9.js";import"./QCard.570fedba.js";const te=$({name:"TotalTableComponent",props:{totalColumns:{type:Array,default:()=>[]},totalRows:{type:Array}},setup(e){const o=f(()=>e.totalColumns.map(r=>({name:r.toLowerCase(),label:r,align:"right",field:r.toLowerCase()}))),a=f(()=>e.totalRows),d=g({page:1,rowsPerPage:i.getItem("totalTableRowsPerPage")||5});return T(()=>{var r;i.set("totalTableRowsPerPage",(r=d.value)==null?void 0:r.rowsPerPage)}),{columns:o,rows:a,initialPagination:d}}}),le={class:"q-pa-md full-width"};function se(e,o,a,d,r,c){return h(),z("div",le,[p(H,{rows:e.rows,columns:e.columns,"row-key":"value",pagination:e.initialPagination,"onUpdate:pagination":o[0]||(o[0]=m=>e.initialPagination=m),"no-data-label":"No records found"},null,8,["rows","columns","pagination"])])}var ae=E(te,[["render",se]]);const ne=$({name:"WalletsTotal",components:{TotalComponent:x,TotalTableComponent:ae},setup(){const e=Z(),o=_(),a=ee(),d=oe(),r=g(!1),c=g(i.getItem("walletsToFilter")||[]),m=g(i.getItem("categoriesToFilter")||[]),w=g(i.getItem("operationsToFilter")||[]),n=e.getWallets,B=a.getCategories,k=d.getOperations,V=f(()=>Array.from(new Set(o.getRecords.map(t=>t.date.slice(0,7))))),v=g(i.getItem("monthsToFilter")||[V.value[0]]);T(()=>i.set("walletsToFilter",c.value||[])),T(()=>i.set("categoriesToFilter",m.value||[])),T(()=>i.set("operationsToFilter",w.value||[])),T(()=>i.set("monthsToFilter",v.value));const q=f(()=>{var t;return["Month","Total",...m.value||[],...((t=w.value)==null?void 0:t.map(s=>s.label))||[]]}),L=t=>{const s=c.value.map(l=>l.label);for(let l=0;l<t.money.length;l++)if(t.money[l].expense&&s.includes(t.money[l].wallet))return!0;return!1},U=(t,s)=>{var l;return((l=t.money.find(u=>u.wallet===s))==null?void 0:l.expense)||0},b=t=>c.value.reduce((s,l)=>s+=U(t,l.label),0),I=f(()=>o.getRecords.filter(t=>v.value.includes(t.date.slice(0,7))&&L(t))),Q=t=>m.value.map(s=>({[s.toLowerCase()]:t.filter(l=>l.operation.category===s).reduce((l,u)=>l+=b(u),0)})),A=t=>w.value.map(s=>({[s.label.toLowerCase()]:t.filter(l=>l.operation.label===s.label).reduce((l,u)=>l+=b(u),0)})),N=t=>t.reduce((s,l)=>s+=b(l),0),O=t=>{const s=I.value.filter(l=>l.date.slice(0,7)===t);return[{month:t},{total:N(s)},...Q(s),...A(s)].reduce((l,u)=>l=y(y({},l),u),{})},j=f(()=>v.value.map(t=>O(t)));return{walletsToFilter:c,wallets:n,categoriesToFilter:m,categories:B,operationsToFilter:w,operations:k,columns:q,rows:j,monthsToFilter:v,months:V,showWallets:r}}}),re={class:"row full-width justify-end q-px-md"},ie={class:"row q-px-md"},me={class:"row justify-center items-start q-gutter-md q-px-md"},ue={class:"row full-width"};function pe(e,o,a,d,r,c){const m=S("TotalComponent"),w=S("TotalTableComponent");return h(),W(K,{class:"column items-start justify-start"},{default:X(()=>[F("div",re,[p(J,{modelValue:e.showWallets,"onUpdate:modelValue":o[0]||(o[0]=n=>e.showWallets=n),label:"Show Wallets",color:"positive"},null,8,["modelValue"])]),F("div",ie,[e.showWallets?(h(),W(m,{key:0,class:"q-mb-md"})):Y("",!0)]),F("div",me,[p(C,{outlined:"",modelValue:e.walletsToFilter,"onUpdate:modelValue":o[1]||(o[1]=n=>e.walletsToFilter=n),multiple:"",options:e.wallets,label:"Filter Wallets",class:"col",style:{"min-width":"150px"}},null,8,["modelValue","options"]),p(C,{outlined:"",modelValue:e.monthsToFilter,"onUpdate:modelValue":o[2]||(o[2]=n=>e.monthsToFilter=n),multiple:"",options:e.months,label:"Months",class:"col",style:{"min-width":"150px"}},null,8,["modelValue","options"]),p(C,{outlined:"",modelValue:e.categoriesToFilter,"onUpdate:modelValue":o[3]||(o[3]=n=>e.categoriesToFilter=n),multiple:"",options:e.categories,label:"Filter Categories",class:"col",style:{"min-width":"150px"}},null,8,["modelValue","options"]),p(C,{outlined:"",modelValue:e.operationsToFilter,"onUpdate:modelValue":o[4]||(o[4]=n=>e.operationsToFilter=n),multiple:"",options:e.operations,label:"Filter Operations",class:"col",style:{"min-width":"150px"}},null,8,["modelValue","options"])]),F("div",ue,[p(w,{totalColumns:e.columns,totalRows:e.rows},null,8,["totalColumns","totalRows"])])]),_:1})}var Se=E(ne,[["render",pe]]);export{Se as default};
